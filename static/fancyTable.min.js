/*!
 * jQuery fancyTable plugin v1.0.22
 * https://github.com/myspace-nu
 *
 * Copyright 2018 Johan Johansson
 * Released under the MIT license
 */

!function(i){i.fn.fancyTable=function(a){var r=i.extend({inputStyle:"",inputPlaceholder:"Search...",pagination:!1,paginationClass:"btn btn-light",paginationClassActive:"active",pagClosest:3,perPage:10,sortable:!0,searchable:!0,matchCase:!1,exactMatch:!1,onInit:function(){},onUpdate:function(){},sortFunction:function(a,t,e){return"numeric"==e.sortAs[e.sortColumn]?0<e.sortOrder?parseFloat(a)-parseFloat(t):parseFloat(t)-parseFloat(a):a<t?-e.sortOrder:t<a?e.sortOrder:0},testing:!1},a),l=this;return this.settings=r,this.tableUpdate=function(n){if(n.fancyTable.matches=0,i(n).find("tbody tr").each(function(){var a=0,t=!0,e=!1;i(this).find("td").each(function(){r.globalSearch||!n.fancyTable.searchArr[a]||l.isSearchMatch(i(this).html(),n.fancyTable.searchArr[a])?!r.globalSearch||n.fancyTable.search&&!l.isSearchMatch(i(this).html(),n.fancyTable.search)||Array.isArray(r.globalSearchExcludeColumns)&&r.globalSearchExcludeColumns.includes(a+1)||(e=!0):t=!1,a++}),r.globalSearch&&e||!r.globalSearch&&t?(n.fancyTable.matches++,!r.pagination||n.fancyTable.matches>n.fancyTable.perPage*(n.fancyTable.page-1)&&n.fancyTable.matches<=n.fancyTable.perPage*n.fancyTable.page?i(this).show():i(this).hide()):i(this).hide()}),n.fancyTable.pages=Math.ceil(n.fancyTable.matches/n.fancyTable.perPage),r.pagination){var a=n.fancyTable.paginationElement?i(n.fancyTable.paginationElement):i(n).find(".pag");a.empty();for(var t,e=1;e<=n.fancyTable.pages;e++)(1==e||e>n.fancyTable.page-(r.pagClosest+1)&&e<n.fancyTable.page+(r.pagClosest+1)||e==n.fancyTable.pages)&&(t=i("<a>",{html:e,"data-n":e,style:"margin:0.2em",class:r.paginationClass+" "+(e==n.fancyTable.page?r.paginationClassActive:"")}).css("cursor","pointer").bind("click",function(){n.fancyTable.page=i(this).data("n"),l.tableUpdate(n)}),e==n.fancyTable.pages&&n.fancyTable.page<n.fancyTable.pages-r.pagClosest-1&&a.append(i("<span>...</span>")),a.append(t),1==e&&n.fancyTable.page>r.pagClosest+2&&a.append(i("<span>...</span>")))}r.onUpdate.call(this,n)},this.isSearchMatch=function(a,t){r.matchCase||(a=a.toUpperCase(),t=t.toUpperCase());var e=r.exactMatch;return"auto"==e&&t.match(/^\".*?\"$/)?(e=!0,t=t.substring(1,t.length-1)):e=!1,e?a==t:new RegExp(t).test(a)},this.reinit=function(a){i(this).each(function(){i(this).find("th a").contents().unwrap(),i(this).find("tr.fancySearchRow").remove()}),i(this).fancyTable(this.settings)},this.tableSort=function(e){var a;void 0!==e.fancyTable.sortColumn&&e.fancyTable.sortColumn<e.fancyTable.nColumns&&(i(e).find("thead th div.sortArrow").each(function(){i(this).remove()}),(a=i("<div>",{class:"sortArrow"}).css({margin:"0.1em",display:"inline-block",width:0,height:0,"border-left":"0.4em solid transparent","border-right":"0.4em solid transparent"})).css(0<e.fancyTable.sortOrder?{"border-top":"0.4em solid #000"}:{"border-bottom":"0.4em solid #000"}),i(e).find("thead th a").eq(e.fancyTable.sortColumn).append(a),a=i(e).find("tbody tr").toArray().sort(function(a,t){a=i(a).find("td").eq(e.fancyTable.sortColumn),t=i(t).find("td").eq(e.fancyTable.sortColumn),a=i(a).data("sortvalue")?i(a).data("sortvalue"):a.html(),t=i(t).data("sortvalue")?i(t).data("sortvalue"):t.html();return"case-insensitive"==e.fancyTable.sortAs[e.fancyTable.sortColumn]&&(a=a.toLowerCase(),t=t.toLowerCase()),r.sortFunction.call(this,a,t,e.fancyTable)}),i(e).find("tbody").empty().append(a))},this.each(function(){if("TABLE"!==i(this).prop("tagName"))return console.warn("fancyTable: Element is not a table."),!0;var e,a,t,n,s=this;s.fancyTable={nColumns:i(s).find("td").first().parent().find("td").length,nRows:i(this).find("tbody tr").length,perPage:r.perPage,page:1,pages:0,matches:0,searchArr:[],search:"",sortColumn:r.sortColumn,sortOrder:void 0!==r.sortOrder&&(new RegExp("desc","i").test(r.sortOrder)||-1==r.sortOrder)?-1:1,sortAs:[],paginationElement:r.paginationElement},0==i(s).find("tbody").length&&(t=i(s).html(),i(s).empty(),i(s).append("<tbody>").append(i(t))),0==i(s).find("thead").length&&i(s).prepend(i("<thead>")),r.sortable&&(n=0,i(s).find("thead th").each(function(){s.fancyTable.sortAs.push("numeric"==i(this).data("sortas")?"numeric":"case-insensitive"==i(this).data("sortas")?"case-insensitive":null);var a=i(this).html(),a=i("<a>",{html:a,"data-n":n,class:""}).css("cursor","pointer").bind("click",function(){s.fancyTable.sortColumn==i(this).data("n")?s.fancyTable.sortOrder=-s.fancyTable.sortOrder:s.fancyTable.sortOrder=1,s.fancyTable.sortColumn=i(this).data("n"),l.tableSort(s),l.tableUpdate(s)});i(this).empty(),i(this).append(a),n++})),r.searchable&&(e=i("<tr>").addClass("fancySearchRow"),r.globalSearch?(a=i("<input>",{placeholder:r.inputPlaceholder,style:"width:100%;"+r.inputStyle}).bind("change paste keyup",function(){s.fancyTable.search=i(this).val(),s.fancyTable.page=1,l.tableUpdate(s)}),t=i("<th>",{style:"padding:2px;"}).attr("colspan",s.fancyTable.nColumns),i(a).appendTo(i(t)),i(t).appendTo(i(e))):(n=0,i(s).find("td").first().parent().find("td").each(function(){s.fancyTable.searchArr.push("");var a=i("<input>",{"data-n":n,placeholder:r.inputPlaceholder,style:"width:100%;"+r.inputStyle}).bind("change paste keyup",function(){s.fancyTable.searchArr[i(this).data("n")]=i(this).val(),s.fancyTable.page=1,l.tableUpdate(s)}),t=i("<th>",{style:"padding:2px;"});i(a).appendTo(i(t)),i(t).appendTo(i(e)),n++})),e.appendTo(i(s).find("thead"))),l.tableSort(s),r.pagination&&!r.paginationElement&&(i(s).find("tfoot").remove(),i(s).append(i("<tfoot><tr></tr></tfoot>")),i(s).find("tfoot tr").append(i("<td class='pag'></td>",{}).attr("colspan",s.fancyTable.nColumns))),l.tableUpdate(s),r.onInit.call(this,s)}),this}}(jQuery);